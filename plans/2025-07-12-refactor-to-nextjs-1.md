# Refactor Frontend to Next.js

## Objective
Refactor the existing frontend, which is a mix of static HTML files and server-side views, to a modern Next.js application. The Express.js backend will be preserved and will serve as an API for the Next.js frontend.

## Implementation Plan
1. **Setup Next.js Project**
  - Dependencies: None
  - Notes: A new Next.js project will be created in a `frontend` directory. This will be the foundation for the new frontend.
  - Files: `frontend/`
  - Status: Not Started
2. **Isolate Express Backend**
  - Dependencies: None
  - Notes: The existing Express application will be modified to exclusively serve API endpoints under the `/api` prefix. All routes that currently serve HTML views will be removed. This will decouple the backend from the frontend.
  - Files: `api/index.js`, `routes/views.js`
  - Status: Not Started
3. **Configure Development Proxy**
  - Dependencies: Task 1, Task 2
  - Notes: A proxy will be configured in the Next.js development environment to forward all API requests (`/api/*`) to the Express backend. This is crucial for seamless development.
  - Files: `frontend/next.config.js`
  - Status: Not Started
4. **Update package.json Scripts**
  - Dependencies: Task 1, Task 2
  - Notes: New scripts will be added to `package.json` to concurrently run the backend and frontend servers during development.
  - Files: `package.json`
  - Status: Not Started
5. **Migrate HTML Views to Next.js Pages**
  - Dependencies: Task 1
  - Notes: All existing HTML pages from the `views` directory will be recreated as React components in the `pages` directory of the Next.js project.
  - Files: `views/`, `frontend/pages/`
  - Status: Not Started
6. **Migrate Static Assets**
  - Dependencies: Task 1
  - Notes: All static assets (CSS, JavaScript, images) will be moved from the `public` directory of the root project to the `public` directory of the Next.js project.
  - Files: `public/`, `frontend/public/`
  - Status: Not Started
7. **Update API Calls in Frontend**
  - Dependencies: Task 5
  - Notes: The frontend code will be updated to make API calls to the relative `/api` endpoints. The Next.js proxy will handle the redirection to the backend.
  - Files: `frontend/`
  - Status: Not Started
8. **Configure Production Server**
  - Dependencies: Task 2, Task 5
  - Notes: The Express server will be configured to serve the static files generated by the Next.js build. A catch-all route will be added to the Express server to serve the `index.html` of the Next.js app.
  - Files: `api/index.js`
  - Status: Not Started
9. **Update Deployment Scripts**
  - Dependencies: Task 8
  - Notes: The deployment scripts will be updated to first build the Next.js application and then start the Express server.
  - Files: `package.json`
  - Status: Not Started

## Verification Criteria
- The new Next.js frontend is fully functional and replaces the old frontend.
- The Express backend remains functional and serves the API to the Next.js frontend.
- The application can be successfully built and deployed.

## Potential Risks and Mitigations
1. **API Incompatibility:** The existing API endpoints might not be perfectly suited for the new Next.js frontend.
  Mitigation: The API can be versioned, or new endpoints can be created to accommodate the needs of the new frontend.
2. **Complex UI Logic:** The existing frontend might have complex UI logic embedded in JavaScript files that is difficult to migrate to React.
  Mitigation: The UI logic will be carefully analyzed and refactored into React components and hooks.
3. **Deployment Complexity:** Deploying a separate frontend and backend can be more complex than a monolithic application.
  Mitigation: A clear and well-documented deployment process will be created.

## Alternative Approaches
1. **Strangler Fig Pattern:** Gradually replace parts of the old frontend with Next.js components, running both frontends simultaneously. This would be a more complex and longer process.
2. **Complete Rewrite:** Rewrite both the frontend and backend from scratch. This would be a much larger undertaking but could lead to a more modern and optimized application.
