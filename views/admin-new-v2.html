<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>T·∫°o b√†i h·ªçc m·ªõi - Giao di·ªán n√¢ng cao</title>
    
    <!-- External Dependencies -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.14/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.14/theme/material.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Custom Styles -->
    <link rel="stylesheet" href="/css/admin-new-v2.css">
    
    <!-- Favicon -->
    <link rel="icon" href="/images/favicon.ico" type="image/x-icon">
</head>
<body>
    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <p>ƒêang kh·ªüi t·∫°o tr√¨nh so·∫°n th·∫£o...</p>
        </div>
    </div>

    <!-- Main Application Container -->
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-left">
                <button class="back-button" onclick="window.location.href='/admin'" title="Quay l·∫°i danh s√°ch">
                    <i class="fas fa-arrow-left"></i>
                    <span>Quay l·∫°i</span>
                </button>
                <div class="header-title">
                    <h1>
                        <i class="fas fa-plus-circle"></i>
                        <span id="lesson-title">T·∫°o b√†i h·ªçc m·ªõi</span>
                    </h1>
                    <div class="lesson-status">
                        <span class="status-indicator" id="save-status">
                            <i class="fas fa-circle"></i>
                            <span>Ch∆∞a l∆∞u</span>
                        </span>
                    </div>
                </div>
            </div>
            
            <div class="header-actions">
                <button class="action-btn secondary" id="preview-btn" title="Xem tr∆∞·ªõc to√†n m√†n h√¨nh">
                    <i class="fas fa-eye"></i>
                    <span>Xem tr∆∞·ªõc</span>
                </button>
                <button class="action-btn secondary" id="save-draft-btn" title="L∆∞u nh√°p">
                    <i class="fas fa-save"></i>
                    <span>L∆∞u nh√°p</span>
                </button>
                <button class="action-btn primary" id="continue-btn" title="Ti·∫øp t·ª•c c·∫•u h√¨nh">
                    <i class="fas fa-arrow-right"></i>
                    <span>Ti·∫øp t·ª•c</span>
                </button>
            </div>
        </header>

        <!-- Main Editor Container -->
        <main class="admin-editor-container">
            <!-- Preview Panel (now on left) -->
            <section class="preview-panel">
                <div class="panel-header">
                    <div class="panel-title">
                        <i class="fas fa-eye"></i>
                        <h2>Xem tr∆∞·ªõc</h2>
                    </div>
                    <div class="panel-actions">
                        <button class="panel-action-btn" id="refresh-preview-btn" title="L√†m m·ªõi xem tr∆∞·ªõc">
                            <i class="fas fa-sync"></i>
                        </button>
                        <button class="panel-action-btn" id="fullscreen-preview-btn" title="To√†n m√†n h√¨nh">
                            <i class="fas fa-expand"></i>
                        </button>
                    </div>
                </div>
                
                <div class="preview-toolbar">
                    <div class="toolbar-group">
                        <button class="toolbar-btn active" id="preview-mode-normal" title="Ch·∫ø ƒë·ªô b√¨nh th∆∞·ªùng">
                            <i class="fas fa-list"></i>
                            <span>Danh s√°ch</span>
                        </button>
                        <button class="toolbar-btn" id="preview-mode-card" title="Ch·∫ø ƒë·ªô th·∫ª">
                            <i class="fas fa-th-large"></i>
                            <span>Th·∫ª</span>
                        </button>
                        <button class="toolbar-btn" id="preview-mode-exam" title="Ch·∫ø ƒë·ªô thi">
                            <i class="fas fa-file-alt"></i>
                            <span>Thi</span>
                        </button>
                    </div>
                    
                    <div class="toolbar-group">
                        <button class="toolbar-btn" id="zoom-out-btn" title="Thu nh·ªè">
                            <i class="fas fa-search-minus"></i>
                        </button>
                        <span class="zoom-level">100%</span>
                        <button class="toolbar-btn" id="zoom-in-btn" title="Ph√≥ng to">
                            <i class="fas fa-search-plus"></i>
                        </button>
                    </div>
                    
                    <div class="toolbar-group">
                        <button class="toolbar-btn" id="validate-btn" title="Ki·ªÉm tra l·ªói">
                            <i class="fas fa-check-circle"></i>
                            <span>Ki·ªÉm tra</span>
                        </button>
                    </div>
                </div>
                
                <div class="preview-content" id="preview-content">
                    <div class="preview-placeholder">
                        <div class="placeholder-icon">
                            <i class="fas fa-file-alt"></i>
                        </div>
                        <h3>Xem tr∆∞·ªõc c√¢u h·ªèi</h3>
                        <p>Nh·∫≠p c√¢u h·ªèi b√™n ph·∫£i ƒë·ªÉ xem k·∫øt qu·∫£ hi·ªÉn th·ªã</p>
                        <div class="placeholder-tips">
                            <h4>M·∫πo s·ª≠ d·ª•ng:</h4>
                            <ul>
                                <li>S·ª≠ d·ª•ng * ƒë·ªÉ ƒë√°nh d·∫•u ƒë√°p √°n ƒë√∫ng</li>
                                <li>ƒê·ªãnh d·∫°ng: C√¢u X: [n·ªôi dung c√¢u h·ªèi]</li>
                                <li>T√πy ch·ªçn: A. B. C. D. cho tr·∫Øc nghi·ªám</li>
                                <li>H·ªó tr·ª£ LaTeX v·ªõi c√∫ ph√°p $...$ ho·∫∑c $$...$$</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="preview-footer">
                    <div class="validation-status" id="validation-status">
                        <span class="status-text">S·∫µn s√†ng ki·ªÉm tra</span>
                    </div>
                    <div class="preview-stats">
                        <span class="stat-item">
                            <i class="fas fa-check-circle text-success"></i>
                            <span id="valid-questions">0</span>
                        </span>
                        <span class="stat-item">
                            <i class="fas fa-exclamation-triangle text-warning"></i>
                            <span id="warning-questions">0</span>
                        </span>
                        <span class="stat-item">
                            <i class="fas fa-times-circle text-error"></i>
                            <span id="error-questions">0</span>
                        </span>
                    </div>
                </div>
            </section>
            
            <!-- Resize Handle -->
            <div class="resize-handle" id="resize-handle">
                <div class="resize-handle-grip">
                    <div class="grip-line"></div>
                    <div class="grip-line"></div>
                    <div class="grip-line"></div>
                </div>
            </div>
            
            <!-- Editor Panel (now on right) -->
            <section class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title">
                        <i class="fas fa-code"></i>
                        <h2>Tr√¨nh so·∫°n th·∫£o</h2>
                    </div>
                    <div class="panel-actions">
                        <button class="panel-action-btn" id="format-btn" title="ƒê·ªãnh d·∫°ng t·ª± ƒë·ªông">
                            <i class="fas fa-magic"></i>
                        </button>
                        <button class="panel-action-btn" id="fullscreen-editor-btn" title="To√†n m√†n h√¨nh">
                            <i class="fas fa-expand"></i>
                        </button>
                    </div>
                </div>
                
                <div class="editor-toolbar">
                    <div class="toolbar-group">
                        <button class="toolbar-btn" id="upload-file-btn" title="T·∫£i l√™n t√†i li·ªáu">
                            <i class="fas fa-upload"></i>
                            <span>T·∫£i l√™n</span>
                        </button>
                        <button class="toolbar-btn" id="upload-image-btn" title="Th√™m h√¨nh ·∫£nh">
                            <i class="fas fa-image"></i>
                            <span>H√¨nh ·∫£nh</span>
                        </button>
                        <button class="toolbar-btn" id="add-latex-btn" title="Th√™m c√¥ng th·ª©c LaTeX">
                            <i class="fas fa-square-root-alt"></i>
                            <span>LaTeX</span>
                        </button>
                    </div>
                    
                    <div class="toolbar-group">
                        <button class="toolbar-btn" id="undo-btn" title="Ho√†n t√°c">
                            <i class="fas fa-undo"></i>
                        </button>
                        <button class="toolbar-btn" id="redo-btn" title="L√†m l·∫°i">
                            <i class="fas fa-redo"></i>
                        </button>
                    </div>
                    
                    <div class="toolbar-group">
                        <select class="toolbar-select" id="question-type-select">
                            <option value="abcd">Tr·∫Øc nghi·ªám ABCD</option>
                            <option value="truefalse">ƒê√∫ng/Sai</option>
                            <option value="number">S·ªë</option>
                        </select>
                    </div>
                    
                    <div class="toolbar-info">
                        <span class="question-count">
                            <i class="fas fa-list-ol"></i>
                            <span id="question-counter">0 c√¢u h·ªèi</span>
                        </span>
                        <span class="word-count">
                            <i class="fas fa-font"></i>
                            <span id="word-counter">0 t·ª´</span>
                        </span>
                    </div>
                </div>
                
                <div class="editor-content">
                    <textarea id="lesson-editor" placeholder="Nh·∫≠p n·ªôi dung b√†i h·ªçc...

V√≠ d·ª•:
C√¢u 1: Trong cu·ªôc khai th√°c thu·ªôc ƒë·ªãa l·∫ßn th·ª© hai ·ªü ƒê√¥ng D∆∞∆°ng 1919-1929, th·ª±c d√¢n Ph√°p t·∫≠p trung ƒë·∫ßu t∆∞ v√†o
*A. Ng√†nh ch·∫ø t·∫°o m√°y.
B. C√¥ng nghi·ªáp luy·ªán kim.
C. ƒê·ªìn ƒëi·ªÅn cao su.
D. C√¥ng nghi·ªáp h√≥a ch·∫•t.

C√¢u 2: N·ªôi dung n√†o sau ƒë√¢y ph·∫£n √°nh ƒë√∫ng t√¨nh h√¨nh Vi·ªát Nam sau Hi·ªáp ƒë·ªãnh Gionevo nƒÉm 1954 v·ªÅ ƒê√¥ng D∆∞∆°ng?
A. ƒê·∫•t n∆∞·ªõc t·∫°m th·ªùi b·ªã chia c·∫Øt l√†m hai mi·ªÅn Nam, B·∫Øc.
*B. Mi·ªÅn B·∫Øc ch∆∞a ƒë∆∞·ª£c gi·∫£i ph√≥ng.
C. Mi·ªÅn Nam ƒë√£ ƒë∆∞·ª£c gi·∫£i ph√≥ng.
D. C·∫£ n∆∞·ªõc ƒë∆∞·ª£c gi·∫£i ph√≥ng v√† ti·∫øn l√™n x√¢y d·ª±ng ch·ªß nghƒ©a x√£ h·ªôi."></textarea>
                </div>
                
                <div class="editor-footer">
                    <div class="editor-status">
                        <span class="cursor-position">D√≤ng 1, C·ªôt 1</span>
                        <span class="encoding">UTF-8</span>
                    </div>
                    <div class="editor-actions">
                        <button class="editor-action-btn" id="clear-btn" title="X√≥a t·∫•t c·∫£">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Document Upload Modal -->
    <div id="document-upload-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>
                    <i class="fas fa-upload"></i>
                    T·∫£i l√™n t√†i li·ªáu
                </h3>
                <button class="modal-close" id="close-upload-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="upload-options">
                    <div class="upload-option" id="manual-option">
                        <div class="option-icon">
                            <i class="fas fa-edit"></i>
                        </div>
                        <div class="option-content">
                            <h4>T·∫°o th·ªß c√¥ng</h4>
                            <p>Nh·∫≠p n·ªôi dung b√†i h·ªçc tr·ª±c ti·∫øp</p>
                        </div>
                    </div>
                    <div class="upload-option" id="file-option">
                        <div class="option-icon">
                            <i class="fas fa-file-upload"></i>
                        </div>
                        <div class="option-content">
                            <h4>T·∫£i l√™n file</h4>
                            <p>AI t·ª± ƒë·ªông x·ª≠ l√Ω PDF/DOCX</p>
                        </div>
                    </div>
                </div>
                <div class="upload-area" id="upload-area" style="display: none;">
                    <div class="upload-dropzone" id="upload-dropzone">
                        <div class="dropzone-content">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>K√©o th·∫£ file v√†o ƒë√¢y ho·∫∑c click ƒë·ªÉ ch·ªçn</p>
                            <input type="file" id="file-input" accept=".pdf,.docx,.txt" multiple>
                        </div>

                        <!-- File Preview -->
                        <div id="file-preview" class="file-preview" style="display: none;">
                            <div class="file-info">
                                <i class="file-icon fas fa-file"></i>
                                <div class="file-details">
                                    <div class="file-name">T√™n file</div>
                                    <div class="file-size">K√≠ch th∆∞·ªõc</div>
                                </div>
                                <button class="remove-file-btn" onclick="removeFile()" title="X√≥a file">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Upload Actions -->
                    <div class="upload-actions" style="margin-top: 20px;">
                        <button class="btn secondary" onclick="closeUploadModal()">H·ªßy</button>
                        <button class="btn primary" id="process-document-btn" onclick="processDocument()" disabled>
                            <i class="fas fa-cog"></i>
                            X·ª≠ l√Ω t√†i li·ªáu
                        </button>
                    </div>

                    <!-- Processing Status -->
                    <div id="processing-status" class="processing-status" style="display: none;">
                        <div class="processing-steps">
                            <div class="processing-step" id="upload-step">
                                <div class="step-icon">
                                    <i class="fas fa-upload"></i>
                                </div>
                                <div class="step-content">
                                    <div class="step-title">T·∫£i l√™n file</div>
                                    <div class="step-description">ƒêang t·∫£i file l√™n server...</div>
                                </div>
                                <div class="step-status">
                                    <i class="fas fa-spinner fa-spin"></i>
                                </div>
                            </div>

                            <div class="processing-step" id="extract-step">
                                <div class="step-icon">
                                    <i class="fas fa-file-text"></i>
                                </div>
                                <div class="step-content">
                                    <div class="step-title">Tr√≠ch xu·∫•t n·ªôi dung</div>
                                    <div class="step-description">ƒêang ƒë·ªçc v√† tr√≠ch xu·∫•t vƒÉn b·∫£n...</div>
                                </div>
                                <div class="step-status">
                                    <i class="fas fa-clock"></i>
                                </div>
                            </div>

                            <div class="processing-step" id="ai-step">
                                <div class="step-icon">
                                    <i class="fas fa-brain"></i>
                                </div>
                                <div class="step-content">
                                    <div class="step-title">X·ª≠ l√Ω AI</div>
                                    <div class="step-description">AI ƒëang ƒë·ªãnh d·∫°ng n·ªôi dung b√†i h·ªçc...</div>
                                </div>
                                <div class="step-status">
                                    <i class="fas fa-clock"></i>
                                </div>
                            </div>

                            <div class="processing-step" id="complete-step">
                                <div class="step-icon">
                                    <i class="fas fa-check"></i>
                                </div>
                                <div class="step-content">
                                    <div class="step-title">Ho√†n th√†nh</div>
                                    <div class="step-description">ƒêang ch√®n n·ªôi dung v√†o tr√¨nh so·∫°n th·∫£o...</div>
                                </div>
                                <div class="step-status">
                                    <i class="fas fa-clock"></i>
                                </div>
                            </div>
                        </div>

                        <div class="processing-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" id="progress-fill"></div>
                            </div>
                            <div class="progress-text" id="progress-text">0%</div>
                        </div>
                    </div>

                    <!-- Upload Error -->
                    <div id="upload-error" class="upload-error" style="display: none;">
                        <div class="error-icon">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <div class="error-content">
                            <div class="error-title">L·ªói x·ª≠ l√Ω t√†i li·ªáu</div>
                            <div class="error-message" id="error-message">ƒê√£ x·∫£y ra l·ªói khi x·ª≠ l√Ω t√†i li·ªáu.</div>
                        </div>
                        <div class="error-actions">
                            <button class="btn secondary" onclick="hideUploadError()">Th·ª≠ l·∫°i</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Image Upload Modal -->
    <div id="image-upload-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>
                    <i class="fas fa-image"></i>
                    Th√™m h√¨nh ·∫£nh
                </h3>
                <button class="modal-close" id="close-image-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="image-upload-tabs">
                    <button class="tab-btn active" data-tab="upload">T·∫£i l√™n</button>
                    <button class="tab-btn" data-tab="url">URL</button>
                    <button class="tab-btn" data-tab="gallery">Th∆∞ vi·ªán</button>
                </div>
                <div class="tab-content active" id="upload-tab">
                    <div class="image-dropzone">
                        <i class="fas fa-images"></i>
                        <p>K√©o th·∫£ h√¨nh ·∫£nh v√†o ƒë√¢y</p>
                        <input type="file" id="image-input" accept="image/*" multiple>
                    </div>
                </div>
                <div class="tab-content" id="url-tab">
                    <div class="url-input-group">
                        <label for="image-url">URL h√¨nh ·∫£nh:</label>
                        <input type="url" id="image-url" placeholder="https://example.com/image.jpg">
                        <button class="btn primary" id="add-url-image">Th√™m</button>
                    </div>
                </div>
                <div class="tab-content" id="gallery-tab">
                    <div class="image-gallery">
                        <p>ƒêang t·∫£i th∆∞ vi·ªán...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- LaTeX Helper Modal -->
    <div id="latex-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>
                    <i class="fas fa-square-root-alt"></i>
                    Tr√¨nh so·∫°n th·∫£o LaTeX
                </h3>
                <button class="modal-close" id="close-latex-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="latex-editor">
                    <textarea id="latex-input" placeholder="Nh·∫≠p c√¥ng th·ª©c LaTeX...

V√≠ d·ª•:
\frac{a}{b}
\sqrt{x^2 + y^2}
\sum_{i=1}^{n} x_i"></textarea>
                    <div class="latex-preview">
                        <div class="preview-title">Xem tr∆∞·ªõc:</div>
                        <div id="latex-preview-content"></div>
                    </div>
                </div>
                <div class="latex-shortcuts">
                    <h4>Ph√≠m t·∫Øt th∆∞·ªùng d√πng:</h4>
                    <div class="shortcuts-grid">
                        <button class="shortcut-btn" data-latex="\frac{a}{b}">Ph√¢n s·ªë</button>
                        <button class="shortcut-btn" data-latex="\sqrt{x}">CƒÉn b·∫≠c hai</button>
                        <button class="shortcut-btn" data-latex="x^2">L≈©y th·ª´a</button>
                        <button class="shortcut-btn" data-latex="x_1">Ch·ªâ s·ªë d∆∞·ªõi</button>
                        <button class="shortcut-btn" data-latex="\sum_{i=1}^{n}">T·ªïng</button>
                        <button class="shortcut-btn" data-latex="\int_{a}^{b}">T√≠ch ph√¢n</button>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn secondary" id="cancel-latex">H·ªßy</button>
                <button class="btn primary" id="insert-latex">Ch√®n</button>
            </div>
        </div>
    </div>

    <!-- Fullscreen Preview Modal -->
    <div id="fullscreen-preview-modal" class="modal fullscreen">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Xem tr∆∞·ªõc to√†n m√†n h√¨nh</h3>
                <button class="modal-close" id="close-fullscreen-preview">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="fullscreen-preview-content"></div>
            </div>
        </div>
    </div>

    <!-- Notification Container -->
    <div id="notification-container" class="notification-container"></div>

    <!-- AI Chatzone -->
    <div id="ai-chatzone" class="ai-chatzone" role="region" aria-label="AI Tr·ª£ l√Ω t·∫°o b√†i h·ªçc">
        <!-- Chat Bubble Toggle -->
        <button id="ai-chat-bubble" class="ai-chat-bubble"
                title="AI Tr·ª£ l√Ω t·∫°o b√†i h·ªçc - Nh·∫•n Ctrl+Alt+A ƒë·ªÉ m·ªü/ƒë√≥ng"
                aria-label="M·ªü AI Tr·ª£ l√Ω t·∫°o b√†i h·ªçc"
                aria-expanded="false">
            <i class="fas fa-robot" aria-hidden="true"></i>
            <div class="bubble-indicator" aria-hidden="true"></div>
        </button>

        <!-- Chat Window -->
        <div id="ai-chat-window" class="ai-chat-window hidden"
             role="dialog"
             aria-labelledby="chat-title"
             aria-hidden="true">
            <div class="chat-header">
                <div class="chat-title" id="chat-title">
                    <i class="fas fa-robot" aria-hidden="true"></i>
                    <span>AI Tr·ª£ l√Ω t·∫°o b√†i h·ªçc</span>
                </div>
                <div class="chat-controls">
                    <button id="ai-chat-close" class="chat-control-btn"
                            title="ƒê√≥ng c·ª≠a s·ªï chat"
                            aria-label="ƒê√≥ng">
                        <i class="fas fa-times" aria-hidden="true"></i>
                    </button>
                </div>
            </div>

            <div class="chat-body">
                <div id="ai-chat-messages" class="chat-messages"
                     role="log"
                     aria-label="L·ªãch s·ª≠ tr√≤ chuy·ªán v·ªõi AI"
                     aria-live="polite">
                    <div class="chat-message ai-message">
                        <div class="message-avatar">
                            <i class="fas fa-robot" aria-hidden="true"></i>
                        </div>
                        <div class="message-content">
                            <div class="message-text">
                                Xin ch√†o! T√¥i l√† AI tr·ª£ l√Ω gi√∫p b·∫°n t·∫°o b√†i h·ªçc. T√¥i c√≥ th·ªÉ:
                                <ul>
                                    <li>üîç <strong>T√¨m ki·∫øm</strong> v√† ph√¢n t√≠ch n·ªôi dung b√†i h·ªçc</li>
                                    <li>‚úèÔ∏è <strong>Ch·ªânh s·ª≠a</strong> v√† c·∫£i thi·ªán c√¢u h·ªèi</li>
                                    <li>‚ûï <strong>Th√™m m·ªõi</strong> c√¢u h·ªèi v√† n·ªôi dung</li>
                                    <li>üí° <strong>G·ª£i √Ω</strong> c·∫£i thi·ªán b√†i h·ªçc</li>
                                </ul>
                                H√£y cho t√¥i bi·∫øt b·∫°n c·∫ßn h·ªó tr·ª£ g√¨!
                            </div>
                            <div class="message-time">V·ª´a xong</div>
                        </div>
                    </div>
                </div>

                <div class="chat-tools" role="toolbar" aria-label="C√¥ng c·ª• AI">
                    <div class="tool-buttons">
                        <button id="ai-tool-search" class="tool-btn"
                                title="T√¨m ki·∫øm n·ªôi dung - Ph√≠m t·∫Øt: Ctrl+1"
                                aria-label="T√¨m ki·∫øm n·ªôi dung">
                            <i class="fas fa-search" aria-hidden="true"></i>
                        </button>
                        <button id="ai-tool-edit" class="tool-btn"
                                title="Ch·ªânh s·ª≠a n·ªôi dung - Ph√≠m t·∫Øt: Ctrl+2"
                                aria-label="Ch·ªânh s·ª≠a n·ªôi dung">
                            <i class="fas fa-edit" aria-hidden="true"></i>
                        </button>
                        <button id="ai-tool-add" class="tool-btn"
                                title="Th√™m n·ªôi dung m·ªõi - Ph√≠m t·∫Øt: Ctrl+3"
                                aria-label="Th√™m n·ªôi dung m·ªõi">
                            <i class="fas fa-plus" aria-hidden="true"></i>
                        </button>
                        <button id="ai-tool-analyze" class="tool-btn"
                                title="Ph√¢n t√≠ch b√†i h·ªçc - Ph√≠m t·∫Øt: Ctrl+4"
                                aria-label="Ph√¢n t√≠ch b√†i h·ªçc">
                            <i class="fas fa-chart-line" aria-hidden="true"></i>
                        </button>
                        <button id="ai-tool-google" class="tool-btn"
                                title="T√¨m ki·∫øm Google - Ph√≠m t·∫Øt: Ctrl+5"
                                aria-label="T√¨m ki·∫øm Google">
                            <i class="fab fa-google" aria-hidden="true"></i>
                        </button>
                        <button id="ai-tool-toggle" class="tool-btn tool-toggle"
                                title="Chuy·ªÉn ƒë·ªïi: URL Context / Code Execution - Ph√≠m t·∫Øt: Ctrl+6"
                                aria-label="Chuy·ªÉn ƒë·ªïi c√¥ng c·ª•"
                                data-mode="url">
                            <i class="fas fa-link" aria-hidden="true"></i>
                        </button>
                    </div>
                </div>
            </div>

            <div class="chat-input-area">
                <div class="chat-input-container">
                    <label for="ai-chat-input" class="sr-only">Nh·∫≠p tin nh·∫Øn cho AI</label>
                    <textarea id="ai-chat-input" class="chat-input"
                              placeholder="Nh·∫≠p tin nh·∫Øn ho·∫∑c y√™u c·∫ßu c·ªßa b·∫°n..."
                              rows="2"
                              aria-label="Nh·∫≠p tin nh·∫Øn cho AI"
                              aria-describedby="ai-chat-status"></textarea>
                    <button id="ai-chat-send" class="chat-send-btn"
                            title="G·ª≠i tin nh·∫Øn - Enter ƒë·ªÉ g·ª≠i"
                            aria-label="G·ª≠i tin nh·∫Øn">
                        <i class="fas fa-paper-plane" aria-hidden="true"></i>
                    </button>
                </div>
                <div class="chat-status" id="ai-chat-status" role="status" aria-live="polite">
                    <span class="status-text">S·∫µn s√†ng</span>
                </div>
            </div>
        </div>
    </div>

    <!-- External Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.14/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.14/mode/javascript/javascript.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>

    <!-- KaTeX Configuration -->
    <script>
        // Configure KaTeX auto-render
        document.addEventListener("DOMContentLoaded", function() {
            if (window.renderMathInElement) {
                renderMathInElement(document.body, {
                    delimiters: [
                        {left: "$$", right: "$$", display: true},
                        {left: "$", right: "$", display: false},
                        {left: "\\[", right: "\\]", display: true},
                        {left: "\\(", right: "\\)", display: false}
                    ],
                    throwOnError: false
                });
            }
        });
    </script>

    <!-- Custom Scripts -->
    <script src="/js/csrf-utils.js?v=2"></script>
    <script src="/js/admin-new-v2.js?v=2"></script>
    <script src="/js/document-upload.js?v=2"></script>
    <script src="/js/storage-recovery.js?v=2"></script>
    <script src="/js/ai-chatzone.js?v=2"></script>
</body>
</html>